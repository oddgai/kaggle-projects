# exp007計画: ブレークスルーを目指す3つの戦略

## 🎯 現状分析と目標設定

### これまでの実験総括

| 実験 | Kaggle | 戦略 | 結果 |
|------|--------|------|------|
| exp001 | 0.77272 | ベースライン（16特徴量） | 基準確立 |
| exp004 | **0.77990** | 高度特徴量（23特徴量） | **最高スコア** |
| exp005 | 0.76315 | アンサンブル（45特徴量） | 過学習失敗 |
| exp006 | 0.77272 | Less is More（15特徴量） | 安定性確認 |

### 重要な学び
1. **特徴量数と性能は比例しない**（exp005の失敗）
2. **適切な特徴量選択が重要**（exp004の成功）
3. **シンプルでも堅実な性能達成可能**（exp006）
4. **CV乖離問題が依然として課題**（全実験共通）

### exp007の目標
- **最低**: Kaggle=0.780（exp004超え）
- **理想**: Kaggle=0.790（大幅改善）
- **挑戦**: Kaggle=0.800（0.8の壁突破）

## 🚀 3つのブレークスルー戦略

### Strategy A: 「Smart Ensemble」- 賢いアンサンブル戦略

**コンセプト**: exp005の失敗から学び、軽量で効果的なアンサンブル

#### 実装アプローチ
```python
# 1. モデル選択（3モデルに限定）
models = [
    LightGBM（exp004最適パラメータ）,
    RandomForest（安定性重視）,
    LogisticRegression（線形補完）
]

# 2. 特徴量差別化
model_features = {
    'lgb': exp004の上位15特徴量,
    'rf': 基本特徴量+交互作用,
    'lr': 統計特徴量中心
}

# 3. 軽量Stacking
- 単純平均ではなく重み付き平均
- CVスコアベースの重み決定
- 過学習監視メトリクス導入
```

#### 期待効果
- **多様性確保**によるロバスト性向上
- **過学習リスク低減**（モデルごとに特徴量制限）
- **計算効率維持**（3モデル限定）

---

### Strategy B: 「Domain Expert」- ドメイン知識活用戦略

**コンセプト**: タイタニック号事故の歴史的事実に基づく特徴量設計

#### 実装アプローチ
```python
# 1. 救命ボート配置ベース特徴量
- 客室位置（デッキ）→救命ボートへの距離
- 乗船港→客室割り当てパターン
- チケット番号→団体客識別

# 2. 社会的階層特徴量
- 称号（Title）の詳細分類
- 家族構成による優先順位
- 女性・子供優先原則の数値化

# 3. 時系列要素
- チケット購入順序（早期購入者の特性）
- 客室番号の連続性（家族・グループ識別）
```

#### 新規特徴量候補
1. **救助優先度スコア**
   - `Priority_Score = (Sex=='female')*100 + (Age<16)*50 + Pclass_inverse*10`

2. **グループ生存確率**
   - 同一チケット/苗字グループの他メンバー生存率

3. **物理的位置スコア**
   - デッキ位置 + 客室位置から推定される避難効率

#### 期待効果
- **ドメイン知識による本質的特徴量**
- **他の参加者と差別化**
- **解釈可能性の向上**

---

### Strategy C: 「Hybrid Neural」- ニューラルネットワーク融合戦略

**コンセプト**: 従来手法とDeep Learningのハイブリッド

#### 実装アプローチ
```python
# 1. Entity Embedding
- カテゴリカル変数の埋め込み表現学習
- Title, Cabin_Deck, Embarkedなど

# 2. シンプルなNN構造
model = Sequential([
    Embedding層（カテゴリカル）,
    Dense(32, activation='relu'),
    Dropout(0.3),
    Dense(16, activation='relu'),
    Dense(1, activation='sigmoid')
])

# 3. LightGBMとの融合
- NN予測値を新特徴量として追加
- またはNN+LGBMの重み付き平均
```

#### 期待効果
- **非線形パターンの捕捉**
- **カテゴリカル変数の高度な表現**
- **新しいアプローチによる改善可能性**

## 📊 戦略評価マトリクス

| 戦略 | 実装難易度 | 期待改善度 | リスク | 推奨度 |
|------|----------|-----------|--------|--------|
| **A: Smart Ensemble** | 中 | 中-高 | 低 | ⭐⭐⭐⭐ |
| **B: Domain Expert** | 低-中 | 高 | 中 | ⭐⭐⭐⭐⭐ |
| **C: Hybrid Neural** | 高 | 不明 | 高 | ⭐⭐⭐ |

## 🎯 推奨実装順序

### 第1候補: Strategy B（Domain Expert）
**理由**:
- 最も独創的で差別化可能
- 実装コスト対効果が高い
- タイタニック固有の知識を最大活用
- 解釈可能性も維持

### 第2候補: Strategy A（Smart Ensemble）
**理由**:
- exp005の失敗から学習済み
- 実装方法が明確
- 安定した改善期待

### 第3候補: Strategy C（Hybrid Neural）
**理由**:
- 挑戦的だが不確実性高い
- 実装に時間がかかる
- 他戦略で改善なければ検討

## 🔬 実装詳細計画

### Strategy B実装ステップ（推奨）

#### Phase 1: ドメイン調査（30分）
1. タイタニック号の構造図確認
2. 救命ボート配置と避難経路
3. 生存者証言からのインサイト

#### Phase 2: 特徴量設計（60分）
1. 救助優先度スコア実装
2. グループ生存確率計算
3. 物理的位置スコア推定
4. 社会的階層詳細化

#### Phase 3: モデル構築（60分）
1. exp004ベースラインに新特徴量追加
2. 特徴量重要度分析
3. 不要特徴量の削除
4. ハイパーパラメータ微調整

#### Phase 4: 検証・提出（30分）
1. CV性能評価
2. 過学習チェック
3. 提出ファイル生成
4. 結果分析

## 📈 成功指標

### 技術的指標
- ✅ **Kaggleスコア**: >0.780（exp004超え）
- ✅ **CV-Kaggle乖離**: <0.065（改善）
- ✅ **特徴量数**: 20-25個（適正範囲）

### 戦略的指標
- ✅ **独創性**: ドメイン知識の効果的活用
- ✅ **再現性**: 明確な理論的根拠
- ✅ **拡張性**: 今後の改善余地確保

## 💡 バックアッププラン

Strategy Bで改善が見られない場合：

1. **Plan B1**: Strategy A（Smart Ensemble）即座に実施
2. **Plan B2**: exp004の特徴量を個別に精査・最適化
3. **Plan B3**: 外部データソース検討（乗客の追加情報）

## 🎯 最終推奨

**exp007 = Strategy B（Domain Expert）の実装を強く推奨**

### 推奨理由
1. **最も論理的**：歴史的事実に基づく
2. **最も独創的**：他参加者との差別化
3. **最も学習価値が高い**：ドメイン知識の重要性体感
4. **失敗してもexp004レベルは維持可能**

---

**「データサイエンスは技術だけでなく、ドメイン理解が鍵」**

この原則をexp007で実証しましょう！